-- MySQL Script generated by MySQL Workbench
-- mié 13 nov 2019 20:13:10 WET
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`Familia`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Familia` (
  `Nombre` VARCHAR(45) NULL,
  `Incompatibilidad` VARCHAR(45) NULL,
  PRIMARY KEY (`Nombre`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Enfermedad`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Enfermedad` (
  `Nombre` VARCHAR(45) NULL,
  `Síntoma` VARCHAR(45) NULL,
  PRIMARY KEY (`Nombre`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Familia_Enfermedad`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Familia_Enfermedad` (
  `Enfermedad_Nombre` VARCHAR(45) NOT NULL,
  `Familia_Nombre` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`Enfermedad_Nombre`, `Familia_Nombre`),
  INDEX `fk_Familia_Enfermedad_Familia1_idx` (`Familia_Nombre` ASC),
  CONSTRAINT `fk_Familia_Enfermedad_Enfermedad`
    FOREIGN KEY (`Enfermedad_Nombre` , `Familia_Nombre`)
    REFERENCES `mydb`.`Enfermedad` (`Nombre` , `Nombre`)
    ON DELETE RESTRICT
    ON UPDATE CASCADE,
  CONSTRAINT `fk_Familia_Enfermedad_Familia1`
    FOREIGN KEY (`Familia_Nombre`)
    REFERENCES `mydb`.`Familia` (`Nombre`)
    ON DELETE RESTRICT
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Laboratorio`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Laboratorio` (
  `Código` INT NOT NULL,
  `Nombre` VARCHAR(45) NULL,
  `Tlfn` INT NULL,
  `Contacto` VARCHAR(45) NULL,
  `Direccion` VARCHAR(45) NULL,
  PRIMARY KEY (`Código`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Medicamentos`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Medicamentos` (
  `Código` INT NOT NULL,
  `Nombre` VARCHAR(45) NULL,
  `Igic` FLOAT NULL,
  `Precio` FLOAT NULL,
  `Posología` VARCHAR(45) NULL,
  `Tipo` VARCHAR(45) NOT NULL,
  `Laboratorio` VARCHAR(45) NULL,
  `Laboratorio_Código` INT NOT NULL,
  PRIMARY KEY (`Código`, `Laboratorio_Código`),
  INDEX `fk_Medicamentos_Laboratorio1_idx` (`Laboratorio_Código` ASC),
  CONSTRAINT `fk_Medicamentos_Laboratorio1`
    FOREIGN KEY (`Laboratorio_Código`)
    REFERENCES `mydb`.`Laboratorio` (`Código`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Familia_has_Medicamentos`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Familia_has_Medicamentos` (
  `Familia_Nombre` VARCHAR(45) NOT NULL,
  `Medicamentos_Código` INT NOT NULL,
  PRIMARY KEY (`Familia_Nombre`, `Medicamentos_Código`),
  INDEX `fk_Familia_has_Medicamentos_Medicamentos1_idx` (`Medicamentos_Código` ASC),
  INDEX `fk_Familia_has_Medicamentos_Familia1_idx` (`Familia_Nombre` ASC),
  CONSTRAINT `fk_Familia_has_Medicamentos_Familia1`
    FOREIGN KEY (`Familia_Nombre`)
    REFERENCES `mydb`.`Familia` (`Nombre`)
    ON DELETE RESTRICT
    ON UPDATE CASCADE,
  CONSTRAINT `fk_Familia_has_Medicamentos_Medicamentos1`
    FOREIGN KEY (`Medicamentos_Código`)
    REFERENCES `mydb`.`Medicamentos` (`Código`)
    ON DELETE RESTRICT
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Compra`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Compra` (
  `Fecha_Actual` DATE NOT NULL,
  `Importe` FLOAT NULL,
  PRIMARY KEY (`Fecha_Actual`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Compra_Medicamento`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Compra_Medicamento` (
  `idCompra_Medicamento` INT NOT NULL,
  `Medicamentos_Código` INT NOT NULL,
  `Fecha_Compra` DATE NOT NULL,
  `Unidades` INT NULL,
  `Igic` FLOAT NULL,
  `Importe` FLOAT NULL,
  PRIMARY KEY (`idCompra_Medicamento`, `Medicamentos_Código`, `Fecha_Compra`),
  INDEX `fk_Compra_Medicamento_idx` (`Medicamentos_Código` ASC),
  INDEX `fk_Fecha_Compra_idx` (`Fecha_Compra` ASC),
  CONSTRAINT `fk_Compra_Medicamento`
    FOREIGN KEY (`Medicamentos_Código`)
    REFERENCES `mydb`.`Medicamentos` (`Código`)
    ON DELETE RESTRICT
    ON UPDATE CASCADE,
  CONSTRAINT `fk_Fecha_Compra`
    FOREIGN KEY (`Fecha_Compra`)
    REFERENCES `mydb`.`Compra` (`Fecha_Actual`)
    ON DELETE RESTRICT
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Pago_Credito`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Pago_Credito` (
  `Cantidad` FLOAT NULL,
  `Fecha_Pago` DATE NULL,
  `Mes_Año` DATE NOT NULL,
  `Fecha_Compra` DATE NOT NULL,
  INDEX `fk_Mes_Año_idx` (`Mes_Año` ASC),
  PRIMARY KEY (`Mes_Año`, `Fecha_Compra`),
  CONSTRAINT `fk_Mes_Año`
    FOREIGN KEY (`Mes_Año`)
    REFERENCES `mydb`.`Compra` (`Fecha_Actual`)
    ON DELETE RESTRICT
    ON UPDATE CASCADE)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `mydb`.`Familia`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Familia` (`Nombre`, `Incompatibilidad`) VALUES ('Antidepresivos', 'Alcohol');
INSERT INTO `mydb`.`Familia` (`Nombre`, `Incompatibilidad`) VALUES ('Antibioticos', NULL);

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Enfermedad`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Enfermedad` (`Nombre`, `Síntoma`) VALUES ('Faringitis', 'Dolor de garganta');
INSERT INTO `mydb`.`Enfermedad` (`Nombre`, `Síntoma`) VALUES ('Depresión', 'Insomnio o hipersomnia');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Familia_Enfermedad`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Familia_Enfermedad` (`Enfermedad_Nombre`, `Familia_Nombre`) VALUES ('Faringitis', 'Antibioticos');
INSERT INTO `mydb`.`Familia_Enfermedad` (`Enfermedad_Nombre`, `Familia_Nombre`) VALUES ('Depresión', 'Antidepresivos');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Laboratorio`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Laboratorio` (`Código`, `Nombre`, `Tlfn`, `Contacto`, `Direccion`) VALUES (01, 'Sanofi', 66677788, 'aaaaaaaaa', 'aaaa');
INSERT INTO `mydb`.`Laboratorio` (`Código`, `Nombre`, `Tlfn`, `Contacto`, `Direccion`) VALUES (02, 'Saval', 666111222, 'bbbbbbbbbbbbb', 'bbbb');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Medicamentos`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Medicamentos` (`Código`, `Nombre`, `Igic`, `Precio`, `Posología`, `Tipo`, `Laboratorio`, `Laboratorio_Código`) VALUES (0001, 'Lizipadol', 3.5, 9, 'Pastillas', 'Receta', 'Sanofi', 01);
INSERT INTO `mydb`.`Medicamentos` (`Código`, `Nombre`, `Igic`, `Precio`, `Posología`, `Tipo`, `Laboratorio`, `Laboratorio_Código`) VALUES (0002, 'Deprax', 4.5, 8.5, 'Pastillas', 'Receta', 'Saval', 02);

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Familia_has_Medicamentos`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Familia_has_Medicamentos` (`Familia_Nombre`, `Medicamentos_Código`) VALUES ('Antibioticos', 0001);
INSERT INTO `mydb`.`Familia_has_Medicamentos` (`Familia_Nombre`, `Medicamentos_Código`) VALUES ('Antidepresivos', 0002);

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Compra`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Compra` (`Fecha_Actual`, `Importe`) VALUES ('2019-11-11', 10);
INSERT INTO `mydb`.`Compra` (`Fecha_Actual`, `Importe`) VALUES ('2019-11-12', 16);

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Compra_Medicamento`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Compra_Medicamento` (`idCompra_Medicamento`, `Medicamentos_Código`, `Fecha_Compra`, `Unidades`, `Igic`, `Importe`) VALUES (11, 0001, '2019-11-11', 1, 3.5, 10);
INSERT INTO `mydb`.`Compra_Medicamento` (`idCompra_Medicamento`, `Medicamentos_Código`, `Fecha_Compra`, `Unidades`, `Igic`, `Importe`) VALUES (22, 0002, '2019-11-12', 2, 3.5, 16);

COMMIT;

